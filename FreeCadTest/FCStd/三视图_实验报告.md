# 三视图实验报告（高中教学）：点的坐标读取与投影练习

## 实验目的

1. 理解三视图（主视图/俯视图/右视图）与三维坐标 (X, Y, Z) 之间的关系。
2. 学会从 FreeCAD 文档（`.FCStd` 解压后的 `Document.xml`）中读取草图点坐标。
3. 掌握将三维点投影到三视图平面上的方法并绘制对应二维坐标。
4. 提高学生的空间想象能力与工程制图基础。

## 实验材料与环境

- Windows 或 macOS/Linux 电脑。
- 已安装 FreeCAD（用于可视化，可选）。
- 已解压的 FreeCAD 文档目录：`123_extracted`（包含 `Document.xml`）。
- Python 3（用于自动提取点坐标，建议 3.8+）。
- 本实验提供的脚本：`extract_points.py`。

## 实验原理与投影规则

采用常见的三视图映射规则（与 CAD 常用对应）：

- 俯视图（Top view） —— 投影到 XY 平面：二维坐标为 (X, Y)。视线方向为 +Z（从上方向下看）。
- 主视图（Front view / 正视图） —— 投影到 XZ 平面：二维坐标为 (X, Z)。视线方向为 -Y（从前方向后看）。
- 右视图（Right view） —— 投影到 YZ 平面：二维坐标为 (Y, Z)。视线方向为 +X（从右侧向左看）。

注：不同教材有略微约定差别，上述规则简明且与本实验提供数据一致。

## 实验步骤（教师示范）

1. 将 `123.FCStd` 复制为 `123.zip` 并解压（你已经完成，目录为 `123_extracted`）。
2. 确认 `123_extracted/Document.xml` 存在。
3. 使用提供脚本 `extract_points.py` 来读取指定草图（例如 `Sketch001`、`Sketch002`）中的点坐标。
4. 按投影规则把每个点投影到三视图平面，记录二维坐标并在方格纸上绘制三视图。
5. 对比绘制结果与 FreeCAD 中的视图（打开 FreeCAD，分别切换到 Top/Front/Right 视图）以验证。

## 练习要求（给学生）

1. 使用脚本提取 `Sketch001` 与 `Sketch002` 中所有被标注或构造的点（exercise 1）。
2. 将下列点投影并填写表格：
   - 从 `Sketch001`：Point A = (25.000000, 60.000000, 0.000000)
   - 从 `Sketch002`：Point B = (30.000000, -15.000000, 0.000000)

   表格示例（填写二维坐标）：

   | 点名 | X | Y | Z | 俯视 (X,Y) | 主视 (X,Z) | 右视 (Y,Z) |
   |---:|---:|---:|---:|:---:|:---:|:---:|
   | A | 25.000 | 60.000 | 0.000 | (25.000, 60.000) | (25.000, 0.000) | (60.000, 0.000) |
   | B | 30.000 | -15.000 | 0.000 | (30.000, -15.000) | (30.000, 0.000) | (-15.000, 0.000) |

3. 在方格纸上绘出 A、B 两点的三视图，并标注尺寸（若有多个点，连线形成轮廓并比较）。
4. 可选：使用 FreeCAD GUI 把草图导出为 PNG，以便与手绘比较。

## 扩展题（思考）

- 若点的 Z 不为 0（例如 12），三视图的主视与右视如何变化？请举例并绘制。
- 若草图被旋转（不在全局 XY 平面），如何把局部草图坐标转换为全局坐标？（提示：使用草图的 Placement 矩阵或 FreeCAD 的 multVec 方法）

## 教师参考：脚本与运行方法

见同目录下 `extract_points.py`。运行方式（在 PowerShell 中）：

```powershell
# 进入解压目录
Set-Location -Path 'd:\FreeCad\FreeCadTest\FCStd\123_extracted'
# 运行脚本，提取 Sketch001 的点
python ..\extract_points.py --xml Document.xml --sketch Sketch001
# 或提取 Sketch002
python ..\extract_points.py --xml Document.xml --sketch Sketch002
```

脚本会输出该草图中所有 GeomPoint 的坐标（X, Y, Z），示例输出：

```
Found 1 GeomPoint(s) in Sketch001:
  Point 1: X=25.000000 Y=60.000000 Z=0.000000
Found 2 GeomPoint(s) in Sketch002:
  Point 1: X=30.000000 Y=-25.000000 Z=0.000000
  Point 2: ...
```

（注：脚本仅提取 `<GeomPoint X=... Y=... Z=.../>` 形式的点。若草图中点通过线段端点推导，教师可增加读取 Geometry 中 LineSegment 的 Start/End）

## 评分细则（示例）

- 正确提取点坐标并填写表格：40%
- 三视图绘制准确（投影位置与标注）：40%
- 回答扩展题与小结：20%

---

> 文件生成：`三视图_实验报告.md`（已写入 `d:\FreeCad\FreeCadTest\FCStd`）
